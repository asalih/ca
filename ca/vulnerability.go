package ca

type Vulnerability struct{
	Severity int64
	Title string
	URL string
	AdditionalData map[string]interface{}
}

func NewVulnerability(response map[string]interface{}, crawlData *CrawlData) *Vulnerability{
	if response["Severity"] == nil || response["Title"] == nil{
		return nil
	}

	var additionalData map[string]interface{}

	if  response["additionalData"] != nil{
		additionalData = response["additionalData"].(map[string]interface{})
	}
	
	return &Vulnerability{response["Severity"].(int64), response["Title"].(string), crawlData.URL.String(), additionalData}
}